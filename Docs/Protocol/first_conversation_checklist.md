# 首次对话检查清单

**版本**: 1.1  
**作者**: Manus AI - 项目策略师  
**日期**: 2025-11-29  
**状态**: Approved

---

## 概述

本文档定义了Manus AI在每个对话开始时必须执行的检查清单，确保Manus了解项目规范、资源位置和工作要求。

### 检查清单的目的

1. **确保规范理解**：确保Manus理解所有人机协同规范
2. **确认资源位置**：确保Manus知道所有资源的位置
3. **明确工作要求**：确保Manus知道本次对话的工作要求
4. **避免遗漏**：避免遗漏关键步骤（如TDD、索引表更新、自检流程）

---

## 首次对话检查清单

### 1. 人机协同规范确认

在每个对话开始时，Manus必须确认已阅读并理解以下规范：

- [ ] **人机协同开发规范**（`docs/collaboration_specification.md`）
  - 理解人机协同的基本原则
  - 理解Manus的角色和职责
  - 理解交付物的标准

- [ ] **两阶段工作流规范**（`docs/workflow_specification.md`）
  - 理解设计阶段和实现阶段的流程
  - 理解Linear工作流（Design → Implementation → Review → Done）
  - 理解MHP的作用和格式

- [ ] **TDD规范**（`docs/tdd_specification.md`）
  - 理解TDD的作用和格式
  - 理解四层架构（数据层、模拟层、粘合层、视觉层）
  - 理解TDD的审查流程
  - 知道参考VOI-6和VOI-11的TDD作为最佳实践

- [ ] **自检流程规范**（`docs/self_check_specification.md`）
  - 理解自检流程的目的和时机
  - 理解自检清单的内容
  - 理解索引表的作用和更新规则
  - 知道对话结束前必须执行自检流程

- [ ] **C++核心模块+蓝图连接开发模式**（`docs/cpp_blueprint_workflow.md`）
  - 理解开发模式的职责划分
  - 理解Manus负责C++核心逻辑
  - 理解用户负责蓝图连接
  - 理解同步方式（通过Git）

---

### 2. 项目资源确认

在每个对话开始时，Manus必须确认以下资源的位置：

#### 2.1 Git仓库

- [ ] **协议仓库**: `gdszyy/ue4-human-ai-collab`
  - 存储：TDD、MHP、规范文档、索引表
  - 路径：`/home/ubuntu/ue4-human-ai-collab`

- [ ] **Game仓库**: `gdszyy/ue4-human-ai-collab-game`
  - 存储：C++代码、蓝图、文档、测试
  - 路径：`/home/ubuntu/ue4-human-ai-collab-game`

#### 2.2 Linear项目

- [ ] **Linear项目**: [ue4游戏开发-人机协同mvp](https://linear.app/voidzyy/project/ue4游戏开发-人机协同mvp-f7f494ca8063)
  - 所有任务都在这个项目中
  - 使用Linear MCP工具与Linear交互

#### 2.3 游戏设计文档（GDD）

- [ ] **GDD**: [Notion GDD v4.0](https://www.notion.so/v4-0-2b8bacf5f26781c0b16ccec48d9750cc)
  - 使用Notion MCP工具访问GDD
  - 关注核心机制，忽略剧情部分

#### 2.4 索引表

- [ ] **索引表**: `docs/task_resource_mapping.md`
  - 记录所有Linear任务与资源的映射关系
  - 在创建/更新资源时必须更新索引表

---

### 3. 工作要求确认

在每个对话开始时，Manus必须确认以下工作要求：

#### 3.1 设计阶段要求

- [ ] **所有设计任务必须先创建TDD**
  - TDD必须明确定义四层架构
  - TDD必须定义所有数据结构和接口
  - TDD必须包含使用示例
  - TDD必须存储在`docs/tech/`目录下

- [ ] **TDD必须审查通过后才能进入实现阶段**
  - 提交TDD到协议仓库
  - 通知用户审查
  - 根据反馈修改TDD

#### 3.2 实现阶段要求

- [ ] **所有实现任务必须遵循四层架构**
  - 数据层：数据结构和数据表
  - 模拟层：GameInstanceSubsystem（纯逻辑引擎）
  - 粘合层：BlueprintLibrary（蓝图接口）
  - 视觉层：蓝图实现

- [ ] **90%开发工作由ManusAI通过UE4 API完成**
  - Manus负责C++核心逻辑
  - 用户负责蓝图连接
  - 通过Git同步代码

- [ ] **所有代码必须包含完整的注释和蓝图使用示例**
  - 头文件必须包含类、函数、参数的注释
  - 头文件必须包含蓝图使用示例
  - 遵循UE4命名规范

#### 3.3 交接阶段要求

- [ ] **所有实现完成的任务必须创建MHP**
  - MHP必须包含实现总结
  - MHP必须列出所有代码位置
  - MHP必须包含测试结果
  - MHP必须记录已知问题
  - MHP必须存储在`docs/mhp/`目录下

#### 3.4 通用要求

- [ ] **对话结束前必须执行自检流程**
  - 检查所有交付物是否符合标准
  - 更新索引表
  - 提交所有文档和代码到Git
  - 生成自检报告

- [ ] **所有任务完成后必须更新索引表**
  - 记录任务ID、标题、状态
  - 记录协议仓库资源位置（TDD、MHP）
  - 记录Game仓库资源位置（代码、文档、测试）

---

### 4. 本次任务确认

在每个对话开始时，Manus必须确认本次任务的信息：

- [ ] **任务ID**: [从用户消息或Linear中获取]
- [ ] **任务标题**: [从用户消息或Linear中获取]
- [ ] **任务状态检查**: **检查任务状态是否为"In Progress"，如果是，必须停止并向用户报告（说明其他对话正在处理此任务）**
- [ ] **锁定任务**: **如果任务状态不是"In Progress"，立即将任务状态更新为"In Progress"（防止其他对话接取同一任务）**
- [ ] **任务目标**: [从用户消息或Linear中获取]
- [ ] **任务阶段**: [设计阶段 | 实现阶段 | 交接阶段]
- [ ] **任务优先级**: [Urgent | High | Medium | Low]
- [ ] **任务依赖**: [列出依赖的其他任务]

---

## 首次对话响应模板

在每个对话开始时，Manus应该使用以下模板向用户确认：

```markdown
## 首次对话确认

您好！我是Manus AI。在开始工作前，我已完成以下确认：

### ✅ 人机协同规范
- ✅ 人机协同开发规范
- ✅ 两阶段工作流规范
- ✅ TDD规范
- ✅ 自检流程规范
- ✅ C++核心模块+蓝图连接开发模式

### ✅ 项目资源
- ✅ 协议仓库: `ue4-human-ai-collab`
- ✅ Game仓库: `ue4-human-ai-collab-game`
- ✅ Linear项目: [ue4游戏开发-人机协同mvp](https://linear.app/voidzyy/project/ue4游戏开发-人机协同mvp-f7f494ca8063)
- ✅ GDD: [Notion GDD v4.0](https://www.notion.so/v4-0-2b8bacf5f26781c0b16ccec48d9750cc)
- ✅ 索引表: `docs/task_resource_mapping.md`

### ✅ 工作要求
- ✅ 设计任务必须先创建TDD
- ✅ 实现任务必须遵循四层架构
- ✅ 90%开发工作由ManusAI通过UE4 API完成
- ✅ 对话结束前必须执行自检流程
- ✅ 任务完成后必须更新索引表

### 📋 本次任务
- **任务ID**: [任务ID]
- **任务标题**: [任务标题]
- **任务目标**: [任务目标]
- **任务阶段**: [设计阶段 | 实现阶段 | 交接阶段]

现在开始工作！
```

---

## 检查清单的集成

### 与工作流的集成

首次对话检查清单应该集成到每个对话的开始：

```
对话开始：
  1. 用户发送第一条消息
  2. Manus执行首次对话检查清单
  3. Manus向用户确认已完成检查
  4. Manus开始执行任务
  ↓
对话进行中：
  [正常工作流程]
  ↓
对话结束前：
  1. Manus执行自检流程
  2. Manus更新索引表
  3. Manus提交所有文档和代码到Git
  4. Manus生成自检报告
  5. Manus向用户报告最终结果
```

### 与Linear工作流的集成

首次对话检查清单应该与Linear工作流集成：

```
Workflow::Design:
  - 执行首次对话检查清单
  - 创建TDD
  - 执行自检流程
  - 更新索引表
  ↓
Workflow::Implementation:
  - 执行首次对话检查清单
  - 实现代码
  - 创建测试
  - 创建实现文档
  - 执行自检流程
  - 更新索引表
  ↓
Workflow::Review:
  - 人类开发者审查
  ↓
Workflow::Done:
  - 任务完成
```

---

## 常见问题

### Q1: 如果用户没有明确指定任务ID，怎么办？

A1: Manus应该主动询问用户：

```markdown
请问您希望我处理哪个Linear任务？您可以提供：
- 任务ID（如VOI-12）
- 任务标题（如"炼金配方系统"）
- 任务链接

或者，您希望我创建一个新任务吗？
```

### Q2: 如果用户的需求不在Linear中，怎么办？

A2: Manus应该建议用户先创建Linear任务：

```markdown
我注意到这个需求还没有对应的Linear任务。建议我们先创建一个Linear任务，以便：
1. 追踪任务进度
2. 记录任务历史
3. 更新索引表

您同意吗？如果同意，请告诉我任务的标题和目标。
```

### Q3: 如果用户要求跳过某些步骤（如TDD），怎么办？

A3: Manus应该礼貌地提醒用户规范的重要性：

```markdown
我理解您希望快速推进，但根据人机协同规范，TDD是必需的，因为：
1. TDD明确定义了四层架构，确保模块解耦
2. TDD作为架构师和开发者之间的契约，避免理解偏差
3. TDD便于后续维护和扩展

如果您确实希望跳过TDD，请明确告知，我会记录这个决策。
```

---

## 总结

首次对话检查清单确保了：

1. **规范理解**：Manus理解所有人机协同规范
2. **资源确认**：Manus知道所有资源的位置
3. **工作要求明确**：Manus知道本次对话的工作要求
4. **避免遗漏**：避免遗漏关键步骤

**Manus在每个对话开始时必须执行首次对话检查清单！**

---

**参考资料**:
1. [人机协同开发规范](collaboration_specification.md)
2. [两阶段工作流规范](workflow_specification.md)
3. [TDD规范](tdd_specification.md)
4. [自检流程规范](self_check_specification.md)
5. [索引表](task_resource_mapping.md)
